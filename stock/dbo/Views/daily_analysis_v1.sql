CREATE view daily_analysis_v1 as select daily_history.[symbol], watch_list.watch_type, daily_history.[seq], daily_history.[date], daily_history.[open], daily_history.[close], daily_history.[high], daily_history.[low], daily_history.[volume], daily_history.[avg], daily_analysis.[dir] as analysis_dir, daily_analysis.[dir_on] as analysis_dir_on, round(daily_analysis.[high_low_perc] * 100, 1) as analysis_high_low_perc, round(daily_analysis.[oc_by_hl_perc] * 100, 1) as analysis_oc_by_hl_perc, round(daily_analysis.[open_close_perc] * 100, 1) as analysis_open_close_perc, daily_analysis.[point1] as analysis_point1, daily_analysis.[point2] as analysis_point2, daily_analysis.[point3] as analysis_point3, round(daily_avg.[after_005_perc] * 100, 1) as avg_after_005_perc, round(daily_avg.[after_010_perc] * 100, 1) as avg_after_010_perc, round(daily_avg.[after_015_perc] * 100, 1) as avg_after_015_perc, round(daily_avg.[after_020_perc] * 100, 1) as avg_after_020_perc, round(daily_avg.[after_040_perc] * 100, 1) as avg_after_040_perc, round(daily_avg.[after_060_perc] * 100, 1) as avg_after_060_perc, round(daily_avg.[after_120_perc] * 100, 1) as avg_after_120_perc, round(daily_avg.[after_240_perc] * 100, 1) as avg_after_240_perc, round(daily_avg.[after_480_perc] * 100, 1) as avg_after_480_perc, round(daily_avg.[after_720_perc] * 100, 1) as avg_after_720_perc, round(daily_avg.[after_960_perc] * 100, 1) as avg_after_960_perc, daily_avg.[change] as avg_change, round(daily_avg.[change_perc] * 100, 1) as avg_change_perc, daily_avg.[ema_005] as avg_ema_005, daily_avg.[ema_012] as avg_ema_012, daily_avg.[ema_020] as avg_ema_020, daily_avg.[ema_026] as avg_ema_026, daily_avg.[ema_060] as avg_ema_060, daily_avg.[ema_120] as avg_ema_120, daily_avg.[macd_12_26] as avg_macd_12_26, daily_avg.[macd_12_26_9] as avg_macd_12_26_9, daily_avg.[macd_12_26_hist] as avg_macd_12_26_hist, daily_avg.[per_fiscal] as avg_per_fiscal, daily_avg.[per_report] as avg_per_report, daily_avg.[rsi_005] as avg_rsi_005, daily_avg.[rsi_012] as avg_rsi_012, daily_avg.[rsi_020] as avg_rsi_020, daily_avg.[rsi_026] as avg_rsi_026, daily_avg.[rsi_060] as avg_rsi_060, daily_avg.[rsi_120] as avg_rsi_120, daily_avg.[sma_005] as avg_sma_005, daily_avg.[sma_012] as avg_sma_012, daily_avg.[sma_020] as avg_sma_020, daily_avg.[sma_026] as avg_sma_026, daily_avg.[sma_060] as avg_sma_060, daily_avg.[sma_120] as avg_sma_120, round(daily_volume.[after_005_perc] * 100, 1) as volume_after_005_perc, round(daily_volume.[after_010_perc] * 100, 1) as volume_after_010_perc, round(daily_volume.[after_015_perc] * 100, 1) as volume_after_015_perc, round(daily_volume.[after_020_perc] * 100, 1) as volume_after_020_perc, round(daily_volume.[after_040_perc] * 100, 1) as volume_after_040_perc, round(daily_volume.[after_060_perc] * 100, 1) as volume_after_060_perc, round(daily_volume.[after_120_perc] * 100, 1) as volume_after_120_perc, round(daily_volume.[after_240_perc] * 100, 1) as volume_after_240_perc, round(daily_volume.[after_480_perc] * 100, 1) as volume_after_480_perc, round(daily_volume.[after_720_perc] * 100, 1) as volume_after_720_perc, round(daily_volume.[after_960_perc] * 100, 1) as volume_after_960_perc, daily_volume.[change] as volume_change, round(daily_volume.[change_perc] * 100, 1) as volume_change_perc, daily_volume.[ema_005] as volume_ema_005, daily_volume.[ema_012] as volume_ema_012, daily_volume.[ema_020] as volume_ema_020, daily_volume.[ema_026] as volume_ema_026, daily_volume.[ema_060] as volume_ema_060, daily_volume.[ema_120] as volume_ema_120, daily_volume.[macd_12_26] as volume_macd_12_26, daily_volume.[macd_12_26_9] as volume_macd_12_26_9, daily_volume.[macd_12_26_hist] as volume_macd_12_26_hist, daily_volume.[obv] as volume_obv, daily_volume.[per_fiscal] as volume_per_fiscal, daily_volume.[per_report] as volume_per_report, daily_volume.[rsi_005] as volume_rsi_005, daily_volume.[rsi_012] as volume_rsi_012, daily_volume.[rsi_020] as volume_rsi_020, daily_volume.[rsi_026] as volume_rsi_026, daily_volume.[rsi_060] as volume_rsi_060, daily_volume.[rsi_120] as volume_rsi_120, daily_volume.[sma_005] as volume_sma_005, daily_volume.[sma_012] as volume_sma_012, daily_volume.[sma_020] as volume_sma_020, daily_volume.[sma_026] as volume_sma_026, daily_volume.[sma_060] as volume_sma_060, daily_volume.[sma_120] as volume_sma_120, daily_volume.[vr] as volume_vr,  getdate() as last_created from daily_history  left outer join daily_analysis on daily_analysis.symbol = daily_history.symbol  and daily_analysis.[date] = daily_history.[date]  left outer join daily_avg on daily_avg.symbol = daily_history.symbol  and daily_avg.[date] = daily_history.[date]  left outer join daily_volume on daily_volume.symbol = daily_history.symbol  and daily_volume.[date] = daily_history.[date] , watch_list WHERE daily_history.symbol = watch_list.symbol 