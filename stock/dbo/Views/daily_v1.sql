CREATE view daily_v1 as select daily_history.[symbol], watch_list.watch_type, daily_history.[seq], daily_history.[date], daily_history.[open], daily_history.[close], daily_history.[high], daily_history.[low], daily_history.[volume], daily_history.[avg], daily_analysis.[dir] as analysis_dir, daily_analysis.[dir_on] as analysis_dir_on, round(daily_analysis.[high_low_perc] * 100, 1) as analysis_high_low_perc, round(daily_analysis.[oc_by_hl_perc] * 100, 1) as analysis_oc_by_hl_perc, round(daily_analysis.[open_close_perc] * 100, 1) as analysis_open_close_perc, daily_analysis.[point1] as analysis_point1, daily_analysis.[point2] as analysis_point2, daily_analysis.[point3] as analysis_point3, round(daily_avg.[after_005_perc] * 100, 1) as avg_after_005_perc, round(daily_avg.[after_010_perc] * 100, 1) as avg_after_010_perc, round(daily_avg.[after_015_perc] * 100, 1) as avg_after_015_perc, round(daily_avg.[after_020_perc] * 100, 1) as avg_after_020_perc, round(daily_avg.[after_040_perc] * 100, 1) as avg_after_040_perc, round(daily_avg.[after_060_perc] * 100, 1) as avg_after_060_perc, round(daily_avg.[after_120_perc] * 100, 1) as avg_after_120_perc, round(daily_avg.[after_240_perc] * 100, 1) as avg_after_240_perc, round(daily_avg.[after_480_perc] * 100, 1) as avg_after_480_perc, round(daily_avg.[after_720_perc] * 100, 1) as avg_after_720_perc, round(daily_avg.[after_960_perc] * 100, 1) as avg_after_960_perc, daily_avg.[change] as avg_change, round(daily_avg.[change_perc] * 100, 1) as avg_change_perc, daily_avg.[ema_005] as avg_ema_005, daily_avg.[ema_012] as avg_ema_012, daily_avg.[ema_020] as avg_ema_020, daily_avg.[ema_026] as avg_ema_026, daily_avg.[ema_060] as avg_ema_060, daily_avg.[ema_120] as avg_ema_120, daily_avg.[macd_12_26] as avg_macd_12_26, daily_avg.[macd_12_26_9] as avg_macd_12_26_9, daily_avg.[macd_12_26_hist] as avg_macd_12_26_hist, daily_avg.[per_fiscal] as avg_per_fiscal, daily_avg.[per_report] as avg_per_report, daily_avg.[rsi_005] as avg_rsi_005, daily_avg.[rsi_012] as avg_rsi_012, daily_avg.[rsi_020] as avg_rsi_020, daily_avg.[rsi_026] as avg_rsi_026, daily_avg.[rsi_060] as avg_rsi_060, daily_avg.[rsi_120] as avg_rsi_120, daily_avg.[sma_005] as avg_sma_005, daily_avg.[sma_012] as avg_sma_012, daily_avg.[sma_020] as avg_sma_020, daily_avg.[sma_026] as avg_sma_026, daily_avg.[sma_060] as avg_sma_060, daily_avg.[sma_120] as avg_sma_120, round(daily_close.[after_005_perc] * 100, 1) as close_after_005_perc, round(daily_close.[after_010_perc] * 100, 1) as close_after_010_perc, round(daily_close.[after_015_perc] * 100, 1) as close_after_015_perc, round(daily_close.[after_020_perc] * 100, 1) as close_after_020_perc, round(daily_close.[after_040_perc] * 100, 1) as close_after_040_perc, round(daily_close.[after_060_perc] * 100, 1) as close_after_060_perc, round(daily_close.[after_120_perc] * 100, 1) as close_after_120_perc, round(daily_close.[after_240_perc] * 100, 1) as close_after_240_perc, round(daily_close.[after_480_perc] * 100, 1) as close_after_480_perc, round(daily_close.[after_720_perc] * 100, 1) as close_after_720_perc, round(daily_close.[after_960_perc] * 100, 1) as close_after_960_perc, daily_close.[change] as close_change, round(daily_close.[change_perc] * 100, 1) as close_change_perc, daily_close.[ema_005] as close_ema_005, daily_close.[ema_012] as close_ema_012, daily_close.[ema_020] as close_ema_020, daily_close.[ema_026] as close_ema_026, daily_close.[ema_060] as close_ema_060, daily_close.[ema_120] as close_ema_120, daily_close.[macd_12_26] as close_macd_12_26, daily_close.[macd_12_26_9] as close_macd_12_26_9, daily_close.[macd_12_26_hist] as close_macd_12_26_hist, daily_close.[per_fiscal] as close_per_fiscal, daily_close.[per_report] as close_per_report, daily_close.[rsi_005] as close_rsi_005, daily_close.[rsi_012] as close_rsi_012, daily_close.[rsi_020] as close_rsi_020, daily_close.[rsi_026] as close_rsi_026, daily_close.[rsi_060] as close_rsi_060, daily_close.[rsi_120] as close_rsi_120, daily_close.[sma_005] as close_sma_005, daily_close.[sma_012] as close_sma_012, round(daily_high.[after_005_perc] * 100, 1) as high_after_005_perc, round(daily_high.[after_010_perc] * 100, 1) as high_after_010_perc, round(daily_high.[after_015_perc] * 100, 1) as high_after_015_perc, round(daily_high.[after_020_perc] * 100, 1) as high_after_020_perc, round(daily_high.[after_040_perc] * 100, 1) as high_after_040_perc, round(daily_high.[after_060_perc] * 100, 1) as high_after_060_perc, round(daily_high.[after_120_perc] * 100, 1) as high_after_120_perc, round(daily_high.[after_240_perc] * 100, 1) as high_after_240_perc, round(daily_high.[after_480_perc] * 100, 1) as high_after_480_perc, round(daily_high.[after_720_perc] * 100, 1) as high_after_720_perc, round(daily_high.[after_960_perc] * 100, 1) as high_after_960_perc, round(daily_high.[change_perc] * 100, 1) as high_change_perc, round(daily_low.[after_005_perc] * 100, 1) as low_after_005_perc, round(daily_low.[after_010_perc] * 100, 1) as low_after_010_perc, round(daily_low.[after_015_perc] * 100, 1) as low_after_015_perc, round(daily_low.[after_020_perc] * 100, 1) as low_after_020_perc, round(daily_low.[after_040_perc] * 100, 1) as low_after_040_perc, round(daily_low.[after_060_perc] * 100, 1) as low_after_060_perc, round(daily_low.[after_120_perc] * 100, 1) as low_after_120_perc, round(daily_low.[after_240_perc] * 100, 1) as low_after_240_perc, round(daily_low.[after_480_perc] * 100, 1) as low_after_480_perc, round(daily_low.[after_720_perc] * 100, 1) as low_after_720_perc, round(daily_low.[after_960_perc] * 100, 1) as low_after_960_perc, round(daily_low.[change_perc] * 100, 1) as low_change_perc, round(daily_open.[after_005_perc] * 100, 1) as open_after_005_perc, round(daily_open.[after_010_perc] * 100, 1) as open_after_010_perc, round(daily_open.[after_015_perc] * 100, 1) as open_after_015_perc, round(daily_open.[after_020_perc] * 100, 1) as open_after_020_perc, round(daily_open.[after_040_perc] * 100, 1) as open_after_040_perc, round(daily_open.[after_060_perc] * 100, 1) as open_after_060_perc, round(daily_open.[after_120_perc] * 100, 1) as open_after_120_perc, round(daily_open.[after_240_perc] * 100, 1) as open_after_240_perc, round(daily_open.[after_480_perc] * 100, 1) as open_after_480_perc, round(daily_open.[after_720_perc] * 100, 1) as open_after_720_perc, round(daily_open.[after_960_perc] * 100, 1) as open_after_960_perc, round(daily_open.[change_perc] * 100, 1) as open_change_perc, round(daily_volume.[after_005_perc] * 100, 1) as volume_after_005_perc, round(daily_volume.[after_010_perc] * 100, 1) as volume_after_010_perc, round(daily_volume.[after_015_perc] * 100, 1) as volume_after_015_perc, round(daily_volume.[after_020_perc] * 100, 1) as volume_after_020_perc, round(daily_volume.[after_040_perc] * 100, 1) as volume_after_040_perc, round(daily_volume.[after_060_perc] * 100, 1) as volume_after_060_perc, round(daily_volume.[after_120_perc] * 100, 1) as volume_after_120_perc, round(daily_volume.[after_240_perc] * 100, 1) as volume_after_240_perc, round(daily_volume.[after_480_perc] * 100, 1) as volume_after_480_perc, round(daily_volume.[after_720_perc] * 100, 1) as volume_after_720_perc, round(daily_volume.[after_960_perc] * 100, 1) as volume_after_960_perc, round(daily_volume.[change_perc] * 100, 1) as volume_change_perc, daily_close.[sma_020] as close_sma_020, daily_close.[sma_026] as close_sma_026, daily_close.[sma_060] as close_sma_060, daily_close.[sma_120] as close_sma_120, daily_high.[change] as high_change, daily_high.[ema_005] as high_ema_005, daily_high.[ema_012] as high_ema_012, daily_high.[ema_020] as high_ema_020, daily_high.[ema_026] as high_ema_026, daily_high.[ema_060] as high_ema_060, daily_high.[ema_120] as high_ema_120, daily_high.[macd_12_26] as high_macd_12_26, daily_high.[macd_12_26_9] as high_macd_12_26_9, daily_high.[macd_12_26_hist] as high_macd_12_26_hist, daily_high.[per_fiscal] as high_per_fiscal, daily_high.[per_report] as high_per_report, daily_high.[rsi_005] as high_rsi_005, daily_high.[rsi_012] as high_rsi_012, daily_high.[rsi_020] as high_rsi_020, daily_high.[rsi_026] as high_rsi_026, daily_high.[rsi_060] as high_rsi_060, daily_high.[rsi_120] as high_rsi_120, daily_high.[sma_005] as high_sma_005, daily_high.[sma_012] as high_sma_012, daily_high.[sma_020] as high_sma_020, daily_high.[sma_026] as high_sma_026, daily_high.[sma_060] as high_sma_060, daily_high.[sma_120] as high_sma_120, daily_low.[change] as low_change, daily_low.[ema_005] as low_ema_005, daily_low.[ema_012] as low_ema_012, daily_low.[ema_020] as low_ema_020, daily_low.[ema_026] as low_ema_026, daily_low.[ema_060] as low_ema_060, daily_low.[ema_120] as low_ema_120, daily_low.[macd_12_26] as low_macd_12_26, daily_low.[macd_12_26_9] as low_macd_12_26_9, daily_low.[macd_12_26_hist] as low_macd_12_26_hist, daily_low.[per_fiscal] as low_per_fiscal, daily_low.[per_report] as low_per_report, daily_low.[rsi_005] as low_rsi_005, daily_low.[rsi_012] as low_rsi_012, daily_low.[rsi_020] as low_rsi_020, daily_low.[rsi_026] as low_rsi_026, daily_low.[rsi_060] as low_rsi_060, daily_low.[rsi_120] as low_rsi_120, daily_low.[sma_005] as low_sma_005, daily_low.[sma_012] as low_sma_012, daily_low.[sma_020] as low_sma_020, daily_low.[sma_026] as low_sma_026, daily_low.[sma_060] as low_sma_060, daily_low.[sma_120] as low_sma_120, daily_open.[change] as open_change, daily_open.[ema_005] as open_ema_005, daily_open.[ema_012] as open_ema_012, daily_open.[ema_020] as open_ema_020, daily_open.[ema_026] as open_ema_026, daily_open.[ema_060] as open_ema_060, daily_open.[ema_120] as open_ema_120, daily_open.[macd_12_26] as open_macd_12_26, daily_open.[macd_12_26_9] as open_macd_12_26_9, daily_open.[macd_12_26_hist] as open_macd_12_26_hist, daily_open.[per_fiscal] as open_per_fiscal, daily_open.[per_report] as open_per_report, daily_open.[rsi_005] as open_rsi_005, daily_open.[rsi_012] as open_rsi_012, daily_open.[rsi_020] as open_rsi_020, daily_open.[rsi_026] as open_rsi_026, daily_open.[rsi_060] as open_rsi_060, daily_open.[rsi_120] as open_rsi_120, daily_open.[sma_005] as open_sma_005, daily_open.[sma_012] as open_sma_012, daily_open.[sma_020] as open_sma_020, daily_open.[sma_026] as open_sma_026, daily_open.[sma_060] as open_sma_060, daily_open.[sma_120] as open_sma_120, daily_source.[adjusted_close] as source_adjusted_close, daily_source.[close] as source_close, daily_source.[dividend_amount] as source_dividend_amount, daily_source.[high] as source_high, daily_source.[low] as source_low, daily_source.[open] as source_open, daily_source.[split_coefficient] as source_split_coefficient, daily_source.[volume] as source_volume, daily_volume.[change] as volume_change, daily_volume.[ema_005] as volume_ema_005, daily_volume.[ema_012] as volume_ema_012, daily_volume.[ema_020] as volume_ema_020, daily_volume.[ema_026] as volume_ema_026, daily_volume.[ema_060] as volume_ema_060, daily_volume.[ema_120] as volume_ema_120, daily_volume.[macd_12_26] as volume_macd_12_26, daily_volume.[macd_12_26_9] as volume_macd_12_26_9, daily_volume.[macd_12_26_hist] as volume_macd_12_26_hist, daily_volume.[obv] as volume_obv, daily_volume.[per_fiscal] as volume_per_fiscal, daily_volume.[per_report] as volume_per_report, daily_volume.[rsi_005] as volume_rsi_005, daily_volume.[rsi_012] as volume_rsi_012, daily_volume.[rsi_020] as volume_rsi_020, daily_volume.[rsi_026] as volume_rsi_026, daily_volume.[rsi_060] as volume_rsi_060, daily_volume.[rsi_120] as volume_rsi_120, daily_volume.[sma_005] as volume_sma_005, daily_volume.[sma_012] as volume_sma_012, daily_volume.[sma_020] as volume_sma_020, daily_volume.[sma_026] as volume_sma_026, daily_volume.[sma_060] as volume_sma_060, daily_volume.[sma_120] as volume_sma_120, daily_volume.[vr] as volume_vr,  getdate() as last_created from daily_history  left outer join daily_analysis on daily_analysis.symbol = daily_history.symbol  and daily_analysis.[date] = daily_history.[date]  left outer join daily_avg on daily_avg.symbol = daily_history.symbol  and daily_avg.[date] = daily_history.[date]  left outer join daily_close on daily_close.symbol = daily_history.symbol  and daily_close.[date] = daily_history.[date]  left outer join daily_high on daily_high.symbol = daily_history.symbol  and daily_high.[date] = daily_history.[date]  left outer join daily_low on daily_low.symbol = daily_history.symbol  and daily_low.[date] = daily_history.[date]  left outer join daily_open on daily_open.symbol = daily_history.symbol  and daily_open.[date] = daily_history.[date]  left outer join daily_source on daily_source.symbol = daily_history.symbol  and daily_source.[date] = daily_history.[date]  left outer join daily_volume on daily_volume.symbol = daily_history.symbol  and daily_volume.[date] = daily_history.[date] , watch_list WHERE daily_history.symbol = watch_list.symbol 